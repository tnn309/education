@model List<EducationSystem.Models.Registration>

@{
    ViewData["Title"] = "Quản lý đăng ký";
}

<h2>Quản lý đăng ký</h2>

@if (Model != null && Model.Any())
{
    <table style="width:100%; border-collapse: collapse; margin-top: 1rem;">
        <thead>
            <tr style="background-color: #f2f2f2;">
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">ID</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Hoạt động</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Người ĐK</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Học sinh</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Phụ huynh</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Ngày ĐK</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Trạng thái</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Thanh toán</th>
                <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Hành động</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var reg in Model)
            {
                <tr>
                    <td style="border: 1px solid #ddd; padding: 8px;">@reg.RegistrationId</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">@reg.Activity?.Title</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">@reg.User?.FullName (@reg.User?.UserName)</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">@reg.Student?.FullName (@reg.Student?.UserName)</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">@(reg.Parent?.FullName ?? "N/A")</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">@reg.RegistrationDate.ToString("dd/MM/yyyy")</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">@reg.Status</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">@reg.PaymentStatus</td>
                    <td style="border: 1px solid #ddd; padding: 8px;">
                        @if (reg.Status == "Pending")
                        {
                            <form asp-controller="Admin" asp-action="ApproveRegistration" method="post" style="display:inline;">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="id" value="@reg.RegistrationId" />
                                <button type="submit" class="approve">Duyệt</button>
                            </form>
                            <form asp-controller="Admin" asp-action="DeclineRegistration" method="post" style="display:inline; margin-left: 5px;">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="id" value="@reg.RegistrationId" />
                                <button type="submit" class="decline">Từ chối</button>
                            </form>
                        }
                        else
                        {
                            <span>Đã xử lý</span>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <p>Không có đăng ký nào để quản lý.</p>
}
